### Classical Discrete Fourier Transform
- Input: length-N vector of complex numbers $x_0,x_1,…,x_{N-1}$
- Output: transformed data $y_0,y_1,…,y_{N-1}$
Definition of FT:
$$
\begin{align*}
y_k = \frac{1}{\sqrt{N}} \sum_{j=0}^{N-1}x_j e^{2\pi i j k/N} &= \frac{1}{\sqrt{N}} \sum_{j=0}^{N-1}\omega_N^{jk}x_j \\
&\omega_N = e^{2\pi/N} \leftarrow \text{N-th root of unity}
\end{align*}
$$

Inverse FT (using [[Kronecker Delta]] identity):
$$
\begin{align*}
x_l &= \frac{1}{\sqrt{N}} \sum_{n=0}^{N-1}y_ne^{-2 \pi i n l/N} = \frac{1}{\sqrt{N}} \sum_{n=0}^{N-1} y_n \left(\omega_N^{jk}\right)^* \\
&= \frac{1}{N} \sum_{n=0}^{N-1} \sum_{j=0}^{N-1} x_je^{2\pi in(j-l)/N} \\
&= \frac{1}{N} \sum_{j=0}^{N-1}x_j N \delta_{jl} = x_l
\end{align*}
$$
Example: For $N=2$: $\omega_2=e^{2 \pi i /2}=-1$
$\Rightarrow F_2=H=\frac{1}{\sqrt{2}} \begin{pmatrix}\omega_2^{0\cdot0} & \omega_2^{0\cdot1} \\ \omega_2^{1\cdot0} & \omega_2^{1\cdot1}\end{pmatrix}=\frac{1}{\sqrt{2}}\begin{pmatrix}1 & 1 \\ 1 & -1\end{pmatrix}$
For arbitrary $N$: Unitary $N \times N$ matrix:

$$

\mathcal{F}_N = \frac{1}{\sqrt{N}} \left(
\begin{array}{ccccc}
\ddots & \vdots & \vdots & \vdots & \\
\cdots & & \omega_N^{jk} & & \cdots \\
& \vdots & \vdots & \vdots & \ddots
\end{array}
\right)
$$

Costs:
- Naively: $O(N)$ steps (multiplication and addition) per entry, thus $O(N^2)$ for length-N vector
- More efficient: **Fast Fourier Transform** (FFT), takes. Only $O(N\log N)$ steps.

### Quantum Fourier Transform (QFT)
QFT acts on orthonormal basis states $|0\rangle,|1\rangle,…,|N-1\rangle$:
$$
|j\rangle \rightarrow \frac{1}{\sqrt{N}} \sum_{k=0}^{N-1}e^{2\pi i j k/N}|k \rangle
$$

Thus, the action on an arbitrary input state

$$
\begin{align*}
\sum_{j=0}^{N-1}x_j |j\rangle &\rightarrow \sum_{j=0}^{N-1}x_j \frac{1}{\sqrt{N}} \sum_{k=0}^{N-1}e^{2\pi i j k/N}|k \rangle \\
&= \sum_{k=0}^{N-1} \left(\frac{1}{\sqrt{N}}\sum_{j=0}^{N-1}x_j e^{2\pi i j k/N} \right)|k \rangle \\
&= \sum_{k=0}^{N-1} y_k |k\rangle
\end{align*}
$$
In the following we will consider $N=2^n$, with $n \in N$ $|0\rangle,|1\rangle,…,|2^n-1\rangle$ are computational basis states of n qubits.
A state $|j\rangle$ can be written in binary representation as $j=j_1j2…j_n$, which stands for
$$
j=j_12^{N-1}+j_22^{N-2} + … + j_{n-1}2^1+j_n2^0
$$
E.g.: $n=3,N=2^3=8$: $|5\rangle=|1\rangle|0\rangle|1\rangle$

We will also use the binary fraction notation

$0.j_lj_{l+1}…j_m=j_l/2 + j_{l+1}/4 + … + j_m/2^{m-l+1}$

Useful Identity:
$$
\begin{align*}
\frac{k}{2^n} &= \frac{k_12^{n-1}+k_22^{n-2}+…+k_n2^0}{2^n} \\
&= k_12^{-1}+k_22^{-2}+…+k_n2^{-n} \\
&= \sum_{l=1}^nk_l 2^{-l}
\end{align*}
$$
The action of the QFT on a ground state is the following:

$$
\begin{align*}
&|j\rangle=|j_1\rangle|j_2\rangle…|j_n\rangle \\
&|j\rangle \rightarrow\frac{1}{\sqrt{2^n}}\sum_{k=0}^{2^n-1}e^{2 \pi i j k/2^n}|k\rangle \\
&= \frac{1}{\sqrt{2^n}} \sum_{k=0}^{2^n-1}e^{2 \pi i j \left(\sum_{l=1}^nk_l 2^{-l}\right)}|k_1\rangle|k_2\rangle…|k_n\rangle \\
&= \frac{1}{\sqrt{2^n}} \sum_{k_1=0}^{1}\sum_{k_2=0}^{1}…\sum_{k_n=0}^{1}e^{2 \pi i j \left(\sum_{l=1}^nk_l 2^{-l}\right)}|k_1\rangle|k_2\rangle…|k_n\rangle \\
&= \frac{1}{\sqrt{2^n}} \bigotimes_{l=1}^n \left[\sum_{k_l=0}^1 e^{2 \pi i j k_l 2^{-l}} |k_l\rangle\right] \\
&= \bigotimes_{l=1}^n \frac{1}{\sqrt{2}} \left(|0\rangle + e^{2 \pi i j/2^l} |1\rangle\right) \\
&= \bigotimes_{l=1}^n |\tilde{k}_l\rangle \\
&= |\tilde{k}_1\rangle \otimes |\tilde{k}_2\rangle \otimes … \otimes |\tilde{k}_n\rangle\\
&= \frac{1}{\sqrt{2}} \left(|0\rangle + e^{2 \pi i 0.j_n} |1\rangle\right) \otimes \frac{1}{\sqrt{2}} \left(|0\rangle + e^{2 \pi i 0.j_{n-1}j_n} |1\rangle\right) \otimes … \otimes \frac{1}{\sqrt{2}} \left(|0\rangle + e^{2 \pi i 0.j_1j_2…j_{n}} |1\rangle\right)
\end{align*}
$$
This is a **product state**, no entanglement is created. In the exponential $\exp\left({2 \pi i \frac{j}{2^l}}\right)$ not all terms are important, as integer multiples of $2 \pi i$ will lead simply to a factor of 1:
$$
\begin{align*}
\rightarrow \exp\left({2 \pi i \frac{j}{2^l}}\right) &= \exp\left(2 \pi i [\frac{1}{2}j_{n-l+1}+\frac{1}{2^2}j_{n-l+2}+…+\frac{1}{2^l}j_n]\right) \\
&=\sum_{m=0}^{l-1}\frac{1}{2^{l-m}}j_{n-m} \\ 
&=0.j_{n-l+1}j_{n-l+2}…j_n
\end{align*}
$$
Only the **last $l$** binary digits of $j$ matter.
$R_k$ can be generated by a [[Rz gate]] up to a global phase: $R_k=e^{\pi i/2^k} R_z(2 \pi/2^k)$. 

$R_k=\begin{pmatrix} 1 & 0 \\ 0 & e^{2 \pi i/2^k} \end{pmatrix}$

Example: $n=3$

$l=1: e^{2 \pi i 0.j_3}=e^{2 \pi i \frac{1}{2}j_3} = \begin{cases} 1 & \text{if } j_3 = 0 \\ -1 & \text{if } j_3=1 \end{cases}$   

$l=2: e^{2 \pi i 0.j_2j_3}=e^{2 \pi i \left(\frac{1}{2}j_2 + \frac{1}{4}j_3\right)}$ (first part Hadamard, second part is a phase drift $R_2$ on qubit 2, depending on $j_3$) 
$l=2: e^{2 \pi i 0.j_1j_2j_3}=e^{2 \pi i \left(\frac{1}{2}j_1 + \frac{1}{4}j_2+\frac{1}{8}j_3\right)}$ (first part Hadamard, second part $R_2$ depending on $j_2$, third part $R_3$ depending on $j_3$) 
#### Circuit Implementation (n=3)
![[Pasted image 20250727174859.png]]

The [[SWAP Gate]] at the end ensures that the qubit order is consistent. Those are not necessary though.

### Circuit Implementation
![[Pasted image 20250727180256.png]]

Resources:
- $n$ [[Hadamard-Gate|Hadamard-Gates]] $O(n)$
- $n(n-1)/2$ conditional rotations $O(n^2)$ (2 [[CNOT gate|CNOTs]] each)
- At most $n/2$ swap gates (3 CNOTs each)
$\Rightarrow O(n^2)$ Quantum Algorithm
Comparison: Best classical algorithm FFT requires $O(n2^n)$ gates.
$\Rightarrow$ QFT provides an **exponential** speedup
Note:
The QFT is **not** an algorithm to speed up the computation of classical Fourier transforms.
Problem:
- No way known to access the amplitudes in a quantum computer directly
- No way now to efficiently prepare original state to be transformed
But: QFT is a key ingredient in other quantum algorithms like [[Quantum Phase Estimation]].